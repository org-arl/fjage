

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The Shell Agent &mdash; fjåge 1.3.3-SNAPSHOT documentation</title>
    
    <link rel="stylesheet" href="_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.3.3-SNAPSHOT',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="fjåge 1.3.3-SNAPSHOT documentation" href="index.html" />
    <link rel="next" title="Simulation" href="simulation.html" />
    <link rel="prev" title="Distributed Agents" href="rmi.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="simulation.html" title="Simulation"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="rmi.html" title="Distributed Agents"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">fjåge 1.3.3-SNAPSHOT documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Shell Agent</a><ul>
<li><a class="reference internal" href="#shell-commands">Shell commands</a></li>
<li><a class="reference internal" href="#remote-shell-over-tcp-ip">Remote shell over TCP/IP</a></li>
<li><a class="reference internal" href="#gui-shell-using-java-swing">GUI shell using Java Swing</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="rmi.html"
                        title="previous chapter">Distributed Agents</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="simulation.html"
                        title="next chapter">Simulation</a></p>
<div id="searchbox" style="overflow:hidden;">
<script>
  (function() {
    var cx = '006023374622006758365:siprl0efik0';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<h3>Search</h3>
<gcse:search></gcse:search>
</div>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="the-shell-agent">
<h1>The Shell Agent<a class="headerlink" href="#the-shell-agent" title="Permalink to this headline">¶</a></h1>
<p>We have already used the console shell provided by fjåge many times. This shell is implemented by the <cite>ShellAgent</cite> class as we have seen before in the <cite>initrc.groovy</cite> scripts. Let&#8217;s take a slightly deeper look at the shell agent in this chapter.</p>
<div class="section" id="shell-commands">
<h2>Shell commands<a class="headerlink" href="#shell-commands" title="Permalink to this headline">¶</a></h2>
<p>The default shell provided by fjåge is a Groovy shell, and can execute any valid Groovy code. A few standard commands, variables and closures are made available. Just typing <cite>help</cite> will provide a list of commands that are available:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">bash$ ./fjage.sh</span>
<span class="gp">&gt;</span> <span class="nb">help</span>
<span class="go">help [topic] - provide help on a specified topic</span>
<span class="go">ps - list all the agents running on the local container</span>
<span class="go">who - display list of variables in workspace</span>
<span class="go">run - run a Groovy script</span>
<span class="go">println - display message on console</span>
<span class="go">delay - delay execution by the specified number of milliseconds</span>
<span class="go">shutdown - shutdown the local platform</span>
<span class="go">logLevel - set loglevel (optionally for a named logger)</span>
<span class="go">subscribe - subscribe to notifications from a named topic</span>
<span class="go">unsubscribe - unsubscribe from notifications for a named topic</span>
<span class="go">shellImport - add specified package/classes to list of imports</span>
<span class="go">agent - return an agent id for the named agent</span>
<span class="go">agentForService - find an agent id providing the specified service</span>
<span class="go">agentsForService - get a list of all agent ids providing the specified service</span>
<span class="go">send - send the given message</span>
<span class="go">request - send the given request and wait for a response</span>
<span class="go">receive - wait for a message</span>
<span class="gp">&gt;</span>
</pre></div>
</div>
<p>Further help on an individual topic can be obtained by typing <cite>help</cite> followed by the topic name. You are encouraged to explore the help.</p>
<p>The commands in the shell are executed in the context of the <cite>ShellAgent</cite> (e.g. messages send are send using this agent). Any messages received by the <cite>ShellAgent</cite> are simply displayed.</p>
<div class="admonition tip">
<p class="first admonition-title">Tip</p>
<p class="last">If you wish to add your own closures or variables, you can do so by customizing initialization script. Initialization scripts can be added to the <cite>ShellAgent</cite> using the <cite>addInitrc</cite> method.</p>
</div>
</div>
<div class="section" id="remote-shell-over-tcp-ip">
<h2>Remote shell over TCP/IP<a class="headerlink" href="#remote-shell-over-tcp-ip" title="Permalink to this headline">¶</a></h2>
<p>If we wanted to provide a remote shell that users could <cite>telnet</cite> into, rather than a console shell, we would replace <cite>ConsoleShell</cite> with a <cite>TcpShell</cite> and specify a TCP/IP port number that is to provide the interactive shell. Here&#8217;s what the resulting <cite>initrc.groovy</cite> would look like:</p>
<div class="highlight-groovy"><pre>import org.arl.fjage.*
import org.arl.fjage.shell.*

platform = new RealTimePlatform()
container = new Container(platform)
shell = new ShellAgent(new TcpShell(8001), new GroovyScriptEngine())
container.add 'shell', shell
// add other agents to the container here
platform.start()</pre>
</div>
<p>We could then access the shell using <cite>telnet</cite>:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">bash$ telnet localhost 8001</span>
<span class="go">Trying localhost...</span>
<span class="go">Connected to localhost</span>
<span class="go">Escape character is &#39;^]&#39;.</span>
<span class="gp">&gt;</span> ps
<span class="go">shell: org.arl.fjage.shell.ShellAgent - IDLE</span>
<span class="gp">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="gui-shell-using-java-swing">
<h2>GUI shell using Java Swing<a class="headerlink" href="#gui-shell-using-java-swing" title="Permalink to this headline">¶</a></h2>
<p>Although the console shell is simple and lightweight, sometimes it is convenient to have a graphical shell with enhanced functionality. A Java Swing based GUI shell can be started in the <cite>initrc.groovy</cite> like this:</p>
<div class="highlight-groovy"><pre>import org.arl.fjage.*
import org.arl.fjage.shell.*

platform = new RealTimePlatform()
container = new Container(platform)
shell = new ShellAgent(new SwingShell(), new GroovyScriptEngine())
container.add 'shell', shell
// add other agents to the container here
platform.start()</pre>
</div>
<p>An option already exists in the default <cite>initrc.groovy</cite> to use the GUI shell. To invoke this, simply start fjåge using <cite>./fjage.sh -gui</cite>. A sample session using the GUI shell is shown below.</p>
<img alt="fjåge SwingShell GUI" class="align-center" src="_images/gui.png" />
<p>The GUI shell displays a separate list in which unsolicited notifications are displayed. Clicking on responses or unsolicited notifications allows closer examination of the messages in the details tab. The GUI can be customized from Groovy shell scripts. Menu items and custom tabbed panels can be added and managed using <cite>guiAddMenu</cite>, <cite>guiGetMenu</cite>, <cite>guiRemoveMenu</cite>, <cite>guiAddPanel</cite>, <cite>guiGetPanel</cite> and <cite>guiRemovePanel</cite> commands. Examples of how to use these are shown in the help available for each command. A following sample script adds a menu item and a tabbed panel to the GUI:</p>
<div class="highlight-groovy"><pre>if (defined('gui')) {    // only call GUI functions if in GUI shell
  guiAddMenu 'Sample', 'Do something', {
    println 'Just do it!'
  }, [acc: 'meta D']
  guiAddPanel 'Demo', new javax.swing.JPanel()
}</pre>
</div>
<p>After executing this script, a new menu item is created. Once invoked by clicking or using the accelerator key <cite>meta-D</cite>, &#8216;do something&#8217; is displayed. The script also adds a blank JPanel in a tab called &#8216;Demo&#8217;.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="simulation.html" title="Simulation"
             >next</a></li>
        <li class="right" >
          <a href="rmi.html" title="Distributed Agents"
             >previous</a> |</li>
        <li><a href="index.html">fjåge 1.3.3-SNAPSHOT documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Mandar Chitre.
    </div>
  </body>
</html>